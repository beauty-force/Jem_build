import{z as V,l as O,L as B,u as p,E as G,r as f,o as n,c as o,d as e,F as z,b,w as x,e as y,i as d,t as c,Z as _,h as F}from"./app.9b52873c.js";import{G as j}from"./GachaButtons.eff2715d.js";import{_ as A}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as H}from"./PlayIcon.d9aa96b5.js";/*! vue-countdown v2.1.2 | (c) 2018-present Chen Fengyuan | MIT */const u=1e3,m=60*u,g=60*m,v=24*g,w="abort",M="end",k="progress",S="start",E="visibilitychange";var q=V({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:s=>s>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:s=>s>=0},transform:{type:Function,default:s=>s}},emits:[w,M,k,S],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/v)},hours(){return Math.floor(this.totalMilliseconds%v/g)},minutes(){return Math.floor(this.totalMilliseconds%g/m)},seconds(){return Math.floor(this.totalMilliseconds%m/u)},milliseconds(){return Math.floor(this.totalMilliseconds%u)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/g)},totalMinutes(){return Math.floor(this.totalMilliseconds/m)},totalSeconds(){return Math.floor(this.totalMilliseconds/u)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(E,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(E,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(S),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const s=Math.min(this.totalMilliseconds,this.interval);if(s>0){let i,t;const h=r=>{i||(i=r),t||(t=r);const a=r-i;a>=s||a+(r-t)/2>=s?this.progress():this.requestId=requestAnimationFrame(h),t=r};this.requestId=requestAnimationFrame(h)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){!this.counting||(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(k,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){!this.counting||(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(w))},end(){!this.counting||(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(M))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return O(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const R={components:{Link:B,PlayIcon:H,VueCountdown:q,GachaButtons:j},props:{gacha:Object,url_edit:String,openCopyModal:Function},data(){return{category_share:p().props.value.category_share,url_card:"",url_10gacha:"",url_1gacha:"",str_gacha10:"",point_10gacha:0,countdown:!0,user:p().props.value.auth.user}},methods:{get_progress_value(){let s=0;this.gacha.count_card>0&&(s=Math.round((this.gacha.count_card-this.gacha.count_rest)*100/this.gacha.count_card));let i="#1a9c4a";return s>40&&(i="#eebf27"),s>70&&(i="#ff2727"),{value:s,color:i}},format_number(s){return String(s).replace(/(.)(?=(\d{3})+$)/g,"$1,")},getImageClass(s){return"url('"+s+"')"},clickCard(){this.url_edit||(window.location.href=this.url_card)},destroyGacha(s){confirm("\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304B\uFF1F")&&G.Inertia.delete(route("admin.gacha.destroy",{id:s}))},transform(s){return Object.entries(s).forEach(([i,t])=>{const h=t<10&&i!="days"?`0${t}`:t;t<2&&i.replace(/s$/,""),s[i]=`${h}`}),s}},mounted(){this.gacha.count_rest<10?(this.str_gacha10="\u5168\u3066",this.point_10gacha=this.gacha.count_rest*this.gacha.point):(this.str_gacha10="10\u9023",this.point_10gacha=10*this.gacha.point),this.url_edit||(this.url_card=route("user.gacha",this.gacha.id)+this.category_share.cat_route_appendix)}},P={class:"cursor-pointer relative w-full overflow-hidden gacha-card p-[2px] md:p-[3px]"},U={class:"bg-neutral-600 h-full flex flex-col"},Y=["data-src"],Z={key:0,class:"absolute z-10 top-0 left-0 items-center px-2 py-1 bg-green-500 border border-transparent rounded-sm font-semibold text-sm text-white tracking-widest"},J={key:1,class:"absolute z-10 top-0 left-0 items-center px-2 py-1 bg-neutral-500 border border-transparent rounded-sm font-semibold text-sm text-white tracking-widest"},K={key:1,class:"absolute bottom-0 w-full h-full bg-opacity-80 z-10 bg-neutral-900 flex flex-col justify-center items-center gap-8"},Q=e("div",{class:"text-white text-[50px] w-full text-center font-black pb-2"},"SOLD OUT",-1),W={class:"w-full flex flex-col justify-center flex-1"},X={class:"text-white font-[mplus2]"},$={class:"flex justify-between items-center pt-1 w-full"},tt={class:"flex items-end gap-2 w-[45%] px-2"},et=e("img",{src:"/images/icon_cash.png",class:"h-5 mb-1"},null,-1),st={class:"text-white text-xl font-bold"},it=e("span",{class:"text-gray-300 text-xs pb-0.5 text-nowrap"},"PT/1\u53E3",-1),at={class:"flex-1 flex flex-col items-end gap-1"},nt={key:0,class:"text-white text-sm pr-2"},ot={key:1,class:"flex items-center pr-2"},rt=e("span",{class:"text-white text-sm pr-2"},"\u6B8B\u308A",-1),lt=e("span",{class:"font-semibold text-lg"},"\u221E",-1),ct=[rt,lt],dt={class:"relative w-full py-2 pl-5 pr-2",style:{background:"linear-gradient(135deg, transparent 20px, #dddddd 0px)"}},ht={class:"relative w-full h-[6px] overflow-hidden shadow-lg"},ut={class:"relative ml-[18px] -mr-0.5"},mt={key:0},gt={key:1},ft={class:"text-center"},_t={class:"bg-gradient-to-r from-rose-600 to-purple-500 via-green-400 bg-clip-text text-transparent font-bold text-xl"},pt={key:0,class:"mr-3"},bt={class:"bg-black py-1 flex items-end"};function xt(s,i,t,h,r,a){const C=f("Link"),I=f("vue-countdown"),N=f("GachaButtons");return n(),o("div",P,[e("div",U,[e("div",{onClick:i[0]||(i[0]=l=>a.clickCard())},[e("img",{"data-src":t.gacha.thumbnail,class:"lazy"},null,8,Y)]),t.url_edit?(n(),o(z,{key:0},[b(C,{href:t.url_edit,class:"absolute z-10 top-0 right-0 items-center px-8 py-2.5 bg-green-500 border border-transparent rounded-sm font-semibold text-sm text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-700 focus:outline-none focus:border-green-700 focus:shadow-outline-green transition ease-in-out duration-150"},{default:x(()=>[y(" \u7DE8\u96C6\u3059\u308B ")]),_:1},8,["href"]),t.gacha.status==1?(n(),o("div",Z," \u516C\u958B ")):(n(),o("div",J," \u975E\u516C\u958B ")),e("button",{onClick:i[1]||(i[1]=l=>t.openCopyModal(t.gacha.id)),class:"z-10 rounded absolute bottom-0 left-0 px-4 py-2 bg-red-500 text-xs text-neutral-50"}," \u30B3\u30D4\u30FC "),e("button",{onClick:i[2]||(i[2]=l=>a.destroyGacha(t.gacha.id)),class:"z-10 rounded absolute bottom-0 right-0 px-4 py-2 bg-red-500 text-xs text-neutral-50"}," \u524A\u9664 ")],64)):d("",!0),t.gacha.count_rest==0&&!t.url_edit?(n(),o("div",K,[Q,e("button",{class:"text-white border border-neutral-300 w-fit rounded-full min-w-[40%] px-5 py-1 hover:bg-neutral-300 hover:text-black",onClick:i[3]||(i[3]=l=>a.clickCard())},"\u6392\u51FA\u5C65\u6B74")])):d("",!0),e("div",W,[e("div",X,[e("div",$,[e("div",tt,[et,e("span",st,c(a.format_number(t.gacha.point)),1),it]),e("div",at,[t.gacha.count_card>0?(n(),o("span",nt,"\u6B8B\u308A "+c(a.format_number(t.gacha.count_rest))+" / "+c(a.format_number(t.gacha.count_card)),1)):(n(),o("div",ot,ct)),e("div",dt,[e("div",ht,[e("div",{class:"pl-3 w-full h-full dark:bg-gray-700 flex justify-end",style:_("background:linear-gradient(135deg, transparent 10px, "+a.get_progress_value().color+"a5 0px)")},[e("div",{class:"h-full bg-white",style:_({width:a.get_progress_value().value+"%"})},null,4)],4)]),e("div",ut,[e("div",{class:"absolute w-3 h-[12px] rounded-full -top-[9px]",style:_({right:a.get_progress_value().value+"%",background:a.get_progress_value().color})},null,4)])])])])]),r.countdown&&t.gacha.remaining>0?(n(),F(I,{key:0,time:t.gacha.remaining*1e3,transform:a.transform,class:"text-gray-100 flex items-center justify-around px-2 py-0.5",onEnd:i[4]||(i[4]=l=>r.countdown=!1)},{default:x(({days:l,hours:T,minutes:L,seconds:D})=>[t.gacha.timeStatus==0?(n(),o("span",mt,"\u767A\u58F2\u307E\u3067")):d("",!0),t.gacha.timeStatus==1?(n(),o("span",gt,"\u7D42\u4E86\u307E\u3067")):d("",!0),e("span",ft,[e("span",_t,[l>0?(n(),o("span",pt,c(l)+"\u65E5",1)):d("",!0),y(c(T)+":"+c(L)+":"+c(D),1)])])]),_:1},8,["time","transform"])):d("",!0)]),e("div",bt,[b(N,{gacha:t.gacha},null,8,["gacha"])])])])}const kt=A(R,[["render",xt]]);export{kt as G};
